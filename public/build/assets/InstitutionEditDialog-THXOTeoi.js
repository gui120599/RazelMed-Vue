import{v as b,x as k,y as C,J as P,c as U,o as g,w as l,b as t,u as e,e as d,a as r,q as w,j as E,s as D,K as v,t as N}from"./app-BlXhyLUO.js";import{t as h}from"./index-BMtI04A1.js";import{_}from"./index-BhtvmoF1.js";import{_ as S,a as B}from"./CardContent.vue_vue_type_script_setup_true_lang-Db3zyTlV.js";import{_ as u}from"./Input.vue_vue_type_script_setup_true_lang-DGIRNgUv.js";import{_ as p,a as m}from"./Label.vue_vue_type_script_setup_true_lang-DXnzPwZ7.js";import{_ as F}from"./Textarea.vue_vue_type_script_setup_true_lang-WgCSZAtK.js";import{_ as R}from"./Checkbox.vue_vue_type_script_setup_true_lang-Ces_goHG.js";import{_ as q,a as A,b as z,c as J,d as O,e as T}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-DcaJZVqV.js";import{S as K}from"./square-pen-DbFA3CZD.js";import"./useForwardExpose-CmaDUOcs.js";import"./useForwardPropsEmits-B3fW3CJG.js";import"./nullish-CtH4V8ap.js";import"./isValueEqualOrExist-BtCHUStO.js";import"./check-BhZWoezT.js";import"./Collection-Y5xl4Jyh.js";import"./RovingFocusGroup-S86I2eBr.js";const M={class:"flex flex-col items-center gap-2"},G={key:0,class:"mb-2"},H=["src"],L={class:"flex items-center space-x-2 mt-2"},Q={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},W={class:"grid lg:col-span-3 w-full gap-2"},X={class:"grid lg:col-span-2 w-full gap-2"},Y={class:"grid lg:col-span-1 w-full gap-2"},Z={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},I={class:"grid w-full gap-2"},ee={class:"grid w-full gap-2"},oe={class:"grid w-full gap-2"},se={class:"flex justify-end items-center gap-4"},$e={__name:"InstitutionEditDialog",props:{institution:{type:Object,required:!0}},setup(V,{expose:$}){const n=V,f=b(!1),o=k({_method:"put",name:n.institution.name,reduced_name:n.institution.reduced_name,email:n.institution.email,phone:n.institution.phone,cnpj:n.institution.cnpj,address:n.institution.address,profile_photo:null,profile_photo_path:n.institution.profile_photo_path,profile_photo_remove:!1});C(()=>n.institution,a=>{o.name=a.name,o.reduced_name=a.reduced_name,o.email=a.email,o.phone=a.phone,o.cnpj=a.cnpj,o.address=a.address,o.profile_photo=null,o.profile_photo_path=a.profile_photo_path,o.profile_photo_remove=!1,o.clearErrors()},{deep:!0});const x=()=>{o.post(route("institutions.update",n.institution.id),{forceFormData:!0,onSuccess:()=>{h.success("Institution updated successfully!"),o.profile_photo=null,o.profile_photo_remove=!1,o.clearErrors(),f.value=!1},onError:a=>{console.error("Validation errors:",a),h.error("Failed to update institution. Please check the form.")}})},y=a=>{o.profile_photo=a.target.files[0],o.profile_photo&&(o.profile_photo_remove=!1)},j=a=>{o.profile_photo_remove=a,a&&(o.profile_photo=null)};return $({isDialogOpen:f,form:o}),(a,s)=>{const c=P("mask");return g(),U(e(T),{open:f.value,"onUpdate:open":s[7]||(s[7]=i=>f.value=i)},{default:l(()=>[t(e(q),{"as-child":""},{default:l(()=>[t(e(_),{variant:"default",title:"EDITAR"},{default:l(()=>[t(e(K))]),_:1})]),_:1}),t(e(A),{class:"lg:min-w-[800px] max-h-[90vh] overflow-y-auto"},{default:l(()=>[t(e(z),null,{default:l(()=>[t(e(J),null,{default:l(()=>s[8]||(s[8]=[d("Edit Institution")])),_:1,__:[8]}),t(e(O),null,{default:l(()=>s[9]||(s[9]=[d("Atualize os dados do institutione.")])),_:1,__:[9]})]),_:1}),t(e(S),null,{default:l(()=>[t(e(B),{class:"space-y-3"},{default:l(()=>[r("form",{class:"space-y-5",onSubmit:w(x,["prevent"])},[r("div",M,[t(e(p),null,{default:l(()=>s[10]||(s[10]=[d("Profile Photo")])),_:1,__:[10]}),e(o).profile_photo_path&&!e(o).profile_photo_remove?(g(),E("div",G,[r("img",{src:`/storage/${e(o).profile_photo_path}`,alt:"Current Profile Photo",class:"w-24 h-24 rounded-full object-cover"},null,8,H)])):D("",!0),t(e(u),{id:"profile_photo",type:"file",onChange:y,class:"max-w-xs"}),t(m,{message:e(o).errors.profile_photo},null,8,["message"]),r("div",L,[t(e(R),{id:"remove_photo",checked:e(o).profile_photo_remove,"onUpdate:checked":j},null,8,["checked"]),t(e(p),{for:"remove_photo"},{default:l(()=>s[11]||(s[11]=[d("Remove current photo")])),_:1,__:[11]})])]),r("div",Q,[r("div",W,[t(e(p),{for:"name"},{default:l(()=>s[12]||(s[12]=[d("Name")])),_:1,__:[12]}),t(e(u),{id:"name",autocomplete:"off",modelValue:e(o).name,"onUpdate:modelValue":s[0]||(s[0]=i=>e(o).name=i)},null,8,["modelValue"]),t(m,{message:e(o).errors.name},null,8,["message"])]),r("div",X,[t(e(p),{for:"reduced_name"},{default:l(()=>s[13]||(s[13]=[d("Nome Reduzido")])),_:1,__:[13]}),t(e(u),{id:"reduced_name",autocomplete:"off",modelValue:e(o).reduced_name,"onUpdate:modelValue":s[1]||(s[1]=i=>e(o).reduced_name=i)},null,8,["modelValue"]),t(m,{message:e(o).errors.reduced_name},null,8,["message"])]),r("div",Y,[t(e(p),{for:"cnpj"},{default:l(()=>s[14]||(s[14]=[d("CPF/CNPJ")])),_:1,__:[14]}),v(t(e(u),{id:"cnpj",autocomplete:"off",modelValue:e(o).cnpj,"onUpdate:modelValue":s[2]||(s[2]=i=>e(o).cnpj=i)},null,8,["modelValue"]),[[c,["###.###.###-##","##.###.###/####-##"]]]),t(m,{message:e(o).errors.cnpj},null,8,["message"])])]),r("div",Z,[r("div",I,[t(e(p),{for:"phone"},{default:l(()=>s[15]||(s[15]=[d("Phone")])),_:1,__:[15]}),v(t(e(u),{type:"tel",autocomplete:"off",id:"phone",modelValue:e(o).phone,"onUpdate:modelValue":s[3]||(s[3]=i=>e(o).phone=i)},null,8,["modelValue"]),[[c,["(##) ####-####","(##)# ####-####"]]]),t(m,{message:e(o).errors.phone},null,8,["message"])]),r("div",ee,[t(e(p),{for:"email"},{default:l(()=>s[16]||(s[16]=[d("Email")])),_:1,__:[16]}),t(e(u),{type:"email",autocomplete:"off",id:"email",modelValue:e(o).email,"onUpdate:modelValue":s[4]||(s[4]=i=>e(o).email=i)},null,8,["modelValue"]),t(m,{message:e(o).errors.email},null,8,["message"])])]),r("div",oe,[t(e(p),{for:"address"},{default:l(()=>s[17]||(s[17]=[d("Address")])),_:1,__:[17]}),t(e(F),{id:"address",autocomplete:"off",modelValue:e(o).address,"onUpdate:modelValue":s[5]||(s[5]=i=>e(o).address=i)},null,8,["modelValue"]),t(m,{message:e(o).errors.address},null,8,["message"])]),r("div",se,[t(e(_),{type:"button",variant:"outline",onClick:s[6]||(s[6]=i=>f.value=!1)},{default:l(()=>s[18]||(s[18]=[d("Cancel")])),_:1,__:[18]}),t(e(_),{type:"submit",disabled:e(o).processing},{default:l(()=>[d(N(e(o).processing?"Updating...":"Update Institution"),1)]),_:1},8,["disabled"])])],32)]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])}}};export{$e as default};
